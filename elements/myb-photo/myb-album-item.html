<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../myb-place/myb-place.html">
<link rel="import" href="../myb-date/myb-date.html">

<dom-module id="myb-album-item">
  <style>
    paper-card {
      height: 100%;
      width: 100%;
      margin-bottom: 16px;
    }

    .title {
      color: var(--default-primary-color);
    }

    iron-image {
      height: 300px;
      width: 100%;
    }

    iron-icon[icon="perm-media"] {
      color: var(--accent-color);
    }
  </style>

  <template>
    <paper-card>
      <div class="layout vertical">
        <div class="card-content flex">
          <div class="layout vertical">
            <a href="{{url(item.gphoto$id.$t)}}">
              <template is="dom-repeat" items="[[item.media$group.media$content]]" as="photo">
                <iron-image cross-fade preload fade src="{{photo.url}}" sizing="cover"></iron-image>
              </template>
            </a>

            <div class="title self-center">
              <h1>{{item.title.$t}}</h1>
            </div>

            <template is="dom-if" if="{{item.media$group.media$description.$t}}">
              <span>{{item.media$group.media$description.$t}}</span>
            </template>
          </div>
        </div>

        <template is="dom-if" if="{{item.gphoto$numphotos.$t}}">
          <div class="card-actions">
            <iron-icon icon="perm-media"></iron-icon>
            <span class="paper-font-body1">{{item.gphoto$numphotos.$t}}</span>
            <span class="paper-font-body1"> photos</span>
          </div>
        </template>

        <template is="dom-if" if="{{item.gphoto$timestamp.$t}}">
          <div class="card-actions">
            <myb-date date="{{date(item.gphoto$timestamp.$t)}}"></myb-date>
          </div>
        </template>

        <template is="dom-if" if="{{item.gphoto$location.$t}}">
          <div class="card-actions">
            <myb-place place="{{item.gphoto$location.$t}}"></myb-place>
          </div>
        </template>
      </div>
    </paper-card>
  </template>

  <script>
    Polymer({
      is: 'myb-album-item',
      properties: {
        item: Object
      },
      url: function (string) {
        return '/albums/' + string;
      },
      date: function (string) {
        return parseInt(string) / 1000;
      },
      toString: function (s) {
        return JSON.stringify(s);
      }
    });
  </script>

</dom-module>
